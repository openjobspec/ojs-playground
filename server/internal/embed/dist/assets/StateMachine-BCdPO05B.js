import{j as n,H as f,P as p,C as h,i as v,B as x}from"./xyflow-CJyVUiIq.js";import{j as r}from"./recharts-DRy4a5l3.js";import{c as y,u as m,a as S,A as j,T,V as A}from"./index-BdKS3nI6.js";const N={scheduled:"bg-ojs-scheduled",available:"bg-ojs-available",pending:"bg-ojs-pending",active:"bg-ojs-active",completed:"bg-ojs-completed",retryable:"bg-ojs-retryable",cancelled:"bg-ojs-cancelled",discarded:"bg-ojs-discarded"},w=r.memo(function({data:t}){const{label:s,state:l,isActive:i,isTerminal:d}=t;return n.jsxs("div",{className:y("rounded-lg border-2 px-4 py-2 text-center text-sm font-medium text-white shadow-sm transition-all",N[l],i&&"ring-2 ring-ring ring-offset-2 ring-offset-background scale-110",d&&"rounded-xl"),children:[n.jsx(f,{type:"target",position:p.Top,className:"!bg-transparent !border-0 !w-2 !h-2"}),s,n.jsx(f,{type:"source",position:p.Bottom,className:"!bg-transparent !border-0 !w-2 !h-2"})]})}),E={stateNode:w},M={scheduled:{x:0,y:0},pending:{x:250,y:0},available:{x:125,y:100},active:{x:125,y:200},completed:{x:0,y:320},retryable:{x:250,y:320},cancelled:{x:-125,y:320},discarded:{x:375,y:320}};function I(){const c=m(e=>e.activeState),t=m(e=>e.simulationResult),s=m(e=>e.activeEventIndex),{resolvedTheme:l}=S(),i=r.useMemo(()=>{if(!t||s<0)return new Set;const e=new Set;for(let a=0;a<=s;a++){const o=t.events[a];o&&e.add(o.to)}return e},[t,s]),d=r.useMemo(()=>{if(!t||s<0)return null;const e=t.events[s];return!e||e.from==="initial"?null:`${e.from}-${e.to}`},[t,s]),g=r.useMemo(()=>j.map(e=>({id:e,type:"stateNode",position:M[e],data:{label:e.charAt(0).toUpperCase()+e.slice(1),state:e,isActive:c===e,isTerminal:T.has(e)},draggable:!1})),[c]),b=r.useMemo(()=>A.filter(e=>e.from!=="initial").map(e=>{const a=`${e.from}-${e.to}`,o=d===a,u=i.has(e.from)&&i.has(e.to);return{id:a,source:e.from,target:e.to,label:e.trigger,type:h.SmoothStep,animated:o,style:{stroke:o?"hsl(var(--primary))":u?"hsl(var(--muted-foreground))":"hsl(var(--border))",strokeWidth:o?2.5:1.5,opacity:o?1:u?.8:.4},labelStyle:{fontSize:10,fill:o?"hsl(var(--foreground))":"hsl(var(--muted-foreground))"},labelBgStyle:{fill:l==="dark"?"hsl(240, 10%, 3.9%)":"hsl(0, 0%, 100%)"}}}),[d,i,l]);return n.jsx("div",{className:"h-full w-full",children:n.jsx(v,{nodes:g,edges:b,nodeTypes:E,fitView:!0,fitViewOptions:{padding:.3},proOptions:{hideAttribution:!0},nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnDrag:!1,zoomOnScroll:!1,zoomOnPinch:!1,zoomOnDoubleClick:!1,children:n.jsx(x,{gap:20,size:1})})})}export{I as StateMachine};
